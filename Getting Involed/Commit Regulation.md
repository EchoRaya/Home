# Git Commit 规范

## 基础规则

### 仅仅Commit相关的修改

commit应该是相关的更改的集合。 例如，修复两个不同的错误应该产生两个单独的commit。 小commit使其他开发人员更容易理解这些更改，并在出现问题时将其回滚。
借助staging area之类的工具和仅分段文件的部分功能，Git可以轻松创建非常细化的commit。

### 尽可能频繁Commit

Commit通常要保持较少的修改，这可以帮助开发者仅关注相关的修改。 此外，它允许更频繁地与其他人分享您的代码。 这样，每个人都可以更容易地定期整合更改，避免合并冲突。 相比之下，较大的提交并且很少分享，会导致发生冲突时很难解决。

### 不要提交未完成的工作

你不应该提交一次未完成的工作。 这并不意味着你必须在提交之前完成一个完整的大功能。 恰恰相反：将功能的实现分割成逻辑块，并记住提前和经常提交。 千万不要仅仅是在一天工作完成后的下班离开办公室时进行提交。 如果你只是因为需要一个干净的工作副本而试图提交（检查分支，引入更改等），请考虑使用Git的“stach”功能。

### 提交前检查代码

即使你非常想这么做，也不要提交一个你认为“完成”了的commit。 彻底测试以确保它确实完成并且没有副作用。 虽然在本地存储库中提交未通过检查的代码只需要你自己反省，但是在push给与他人共享代码时，commit前测试一次代码就显得非常重要。

### 认真编写Commit信息

以您的更改摘要（最多50个字符作为指导）开始您的消息。 从中分离出来
通过包括一个空白行，以下正文。 您的信息正文应该对以下问题提供详细的答案：
- 改变的动机是什么？ - 它与以前有什么不同？
实施？
使用命令式，现在式（“更改”，而不是“更改”或“更改”）与git merge等命令生成的消息一致。
将文件备份到远程服务器上对于使用版本控制系统是一个很好的副作用。 但是您不应该像使用备份系统一样使用您的VCS。 在进行版本控制时，您应该注意语义上的提交（请参阅«相关更改»） - 您不应该只是在文件中填充。

信息开始应当是你的修改的简要介绍，且不应超过50字。使用一个空行
Begin your message with a short summary of your changes (up to 50 characters as a guideline). Separate it from
the following body by including a blank line. The body of your message should provide detailed answers to the following questions:
– What was the motivation for the change? – How does it differ from the previous
implementation?
Use the imperative, present tense («change», not «changed» or «changes») to be consistent with generated messages from commands like git merge.
Having your files backed up on a remote server is a nice side effect of having a version control system. But you should not use your VCS like it was a backup system. When doing version control, you should pay attention to committing semantically (see «related changes») - you shouldn‘t just cram in files.

### Use Branches

Branching is one of Git‘s most powerful features - and this is not by accident: quick and easy branching was a central requirement from day one. Branches are the perfect tool to help you avoid mixing up different lines of development. You should use branches extensively in your development workflows: for new features, bug fixes, ideas...

### Agree on A Workflow

Git lets you pick from a lot of different workflows: long-running branches, topic branches, merge or rebase, git-flow... Which one you choose depends on a couple of factors: your project, your overall development and deployment workflows and (maybe most importantly) on your and your teammates‘ personal preferences. However you choose to work, just make sure to agree on a common workflow that everyone follows.

The following document is based on experience doing code development, bug troubleshooting and code review across a number of projects using GIT, including libvirt, QEMU and OpenStack Nova. Examination of other open source projects such as the Kernel, CoreUtils, GNULIB and more suggested they all follow a fairly common practice. It is motivated by a desire to improve the quality of the Nova GIT history. Quality is a hard term to define in computing; one man's "Thing of Beauty" is another man's "Evil Hack". We can, however, come up with some general guidelines for what to do, or conversely what not to do, when publishing GIT commits for merge with a project, in this case, OpenStack.

This topic can be split into two areas of concern

* The structured set/split of the code changes
* The information provided in the commit message

## Formatting Rules

- Capitalized, short __(50 chars or less)__ summary

- More detailed explanatory text, if necessary.  __Wrap it to about 72 characters__.  In some contexts, the first line is treated as the subject of an email and the rest of the text as the body.  The blank line separating the summary from the body is critical (unless you omit the body entirely); tools like rebase can get confused if you run the two together.

- __Always leave the second line blank.__

- Write your commit message in the imperative: "Fix bug" and not "Fixed bug" or "Fixes bug."  This convention matches up with commit messages generated by commands like git merge and git revert.

- Further paragraphs come after blank lines.
    - Bullet points are okay, too
    - Typically a hyphen or asterisk is used for the bullet, preceded by a single space, with blank lines in between, but conventions vary here
    - Use a hanging indent

### Examples of good practice

__Example 1__ (no description, only summary)

```
  commit 3114a97ba188895daff4a3d337b2c73855d4632d
  Author: [removed]
  Date:   Mon Jun 11 17:16:10 2012 +0100

    Update default policies for KVM guest PIT & RTC timers
```

__Example 2__ (description as bullet points)
```
  commit ae878fc8b9761d099a4145617e4a48cbeb390623
  Author: [removed]
  Date:   Fri Jun 1 01:44:02 2012 +0000

    Refactor libvirt create calls

     - Minimize duplicated code for create

     - Make wait_for_destroy happen on shutdown instead of undefine

     - Allow for destruction of an instance while leaving the domain
```

__Example 3__ (description as plain text)

```
  commit 31336b35b4604f70150d0073d77dbf63b9bf7598
  Author: [removed]
  Date:   Wed Jun 6 22:45:25 2012 -0400

    Add CPU arch filter scheduler support

    In a mixed environment of running different CPU architectures,
    one would not want to run an ARM instance on a X86_64 host and
    vice versa.

    This scheduler filter option will prevent instances running
    on a host that it is not intended for.

    The libvirt driver queries the guest capabilities of the
    host and stores the guest arches in the permitted_instances_types
    list in the cpu_info dict of the host.

    The Xen equivalent will be done later in another commit.

    The arch filter will compare the instance arch against
    the permitted_instances_types of a host
    and filter out invalid hosts.

    Also adds ARM as a valid arch to the filter.

    The ArchFilter is not turned on by default.
```